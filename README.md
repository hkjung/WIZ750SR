# WIZ750SR with Thing+ Client

## WIZ750SR
WIZnet Serial to Ethernet(S2E) module based on W7500 chip, WIZ107/108SR S2E compatible device

## About W7500x Thing+ Client Library

This is Thing+ MQTT library for **WIZnet W7500x MCU**, The source code based on **Thing+ Arduino library v1.0.6**<br>
You can make your own IoT application fast with Thing+<br>

Here is Thing+ arduino_libaray features.<br>

- Connect Thing+ via MQTT
- Send gateway and sensors status to Thing+
- Send sensors value to Thing+
- Receive actuator commands from Thing+
- Automatic time synchronzing

The difference between the existing arduino library and W7500x MCU library.<br>

- Changed the C++ based arduino library to the C based W7500x library
  - The 'thingplus_' string added to each function name
  - There are some differences in function internal operations.
- Changed the boolean return type to uint8_t return type
- The function parameters changed about a change in some libraries.
  - MQTT: PubSubClient library -> Eclipse Paho library
  - JSON: ArduinoJSON library -> cJSON library
  - begin(), actuatorCallbackSet() functions are affected.

### You can download the original Thing+ arduino library from here:<br>
https://github.com/daliworks/arduino_library

#### When Gateway Registration to The thing+ portal, the 'Gateway Model' should be selected as 'Arduino - Developer.<br>
http://support.thingplus.net/en/open-hardware/arduino-noSSL-user-guide.html

## APIs
#### void thingplus_begin(uint8_t *mac, uint8_t *apikey)
```
   Description : Initialize the Thing+ library
   Parameter
		- mac : mac address
		- apikey : apikey generated by Thing+
		           You can get apikey from Thing+ Portal       
```

#### void thingplus_connect(void)
```
   Description : Connect Thing+ via MQTT
                 Before call this API, W7500x Device MUST CONNECT INTERNET.
```
#### void thingplus_disconnect(void)
```
   Description : Disconnecting Thing+
```

#### uint8_t thingplus_loop(void)
```
   Description : Doing MQTT related works.
                 W7500x Device MUST CALL THIS API PERIODICALLY
```
#### uint8_t thingplus_gatewayStatusPublish(uint8_t on, time_t durationSec)
```
   Description : Send gateway status to Thing+
   Parameter
      - on : True if gateway is on, false if gateway is off
      - validSec : Valid time. Unit is second.
                   You must resend the status before timeout.
                   If timeouted, the status is considered as error
```

#### uint8_t thingplus_sensorStatusPublish(const uint8_t *id, uint8_t on, time_t durationSec)
```
   Description : Send sensor status to Thing+
   Parameter
      - id : Sensor id.
      - on : True if sensor is on, false if sensor is off
      - validSec : Valid time. Unit is second.
                   You must resend the status before timeout.
                   If timeouted, the status is considered as error
```

#### uint8_t thingplus_valuePublish_str(const uint8_t *id, char *value)
```
   Description : Send sensor sting value to Thing+
   Parameter
      - id : Sensor id.
      - value : Sensor value
```

#### uint8_t thingplus_valuePublish_int(const uint8_t *id, int value)
```
   Description : Send sensor interger value to Thing+
   Parameter
      - id : Sensor id.
      - value : Sensor value
```

#### uint8_t thingplus_valuePublish_float(const uint8_t *id, float value)
```
   Description : Send sensor float value to Thing+
   Parameter
      - id : Sensor id.
      - value : Sensor value
```

#### uint8_t thingplus_actuatorCallbackSet(uint8_t* (*cb)(const uint8_t* id, const uint8_t* cmd, cJSON *options))
```
   Description : Register actuator callback function.
   Parameter
      - cb : Callback function pointer.
```

<br>

